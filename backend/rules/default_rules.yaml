rules:
  - id: "SAST-001"
    pattern: "(?i)(password|secret|api_key|access_token)\\s*=\\s*['\\\"][a-zA-Z0-9_\\-]{3,}['\\\"]"
    message: "Possible hardcoded secret detected."
    severity: "BLOCKING"
    category: "SECURITY"
    link: "https://cwe.mitre.org/data/definitions/798.html"
  
  - id: "SAST-002"
    pattern: "(?i)eval\\s*\\("
    message: "Use of 'eval()' is dangerous and can lead to RCE."
    severity: "BLOCKING"
    category: "SECURITY"

  - id: "SAST-003"
    pattern: "(?i)exec\\s*\\("
    message: "Use of 'exec()' is dangerous."
    severity: "WARNING"
    category: "SECURITY"
    
  - id: "LOG-001"
    pattern: "(?i)print\\s*\\("
    message: "Avoid using print() in production. Use a logger."
    severity: "INFO"
    category: "STYLE"

  - id: "LOG-002"
    pattern: "(?i)logging\\.getLogger\\("
    message: "Ensure logger is configured correctly (just a check)."
    severity: "INFO"
    category: "STYLE"
    
  - id: "SAST-004"
    pattern: "(?i)(SELECT|INSERT|UPDATE|DELETE).*\\+.*"
    message: "Potential SQL Injection detected (String concatenation in SQL)."
    severity: "BLOCKING"
    category: "SECURITY"
    link: "https://owasp.org/www-community/attacks/SQL_Injection"

  - id: "SAST-005"
    pattern: "(?i)(os\\.system|subprocess\\.Popen|subprocess\\.call)"
    message: "Unsafe system command execution detected. Ensure input sanitization."
    severity: "WARNING"
    category: "SECURITY"

  - id: "STYLE-002"
    pattern: "class\\s+[a-z]"
    message: "Class names should use CapWords convention (PEP8)."
    severity: "INFO"
    category: "STYLE"

  - id: "ERR-001"
    pattern: "except\\s*:"
    message: "Avoid bare 'except:' blocks. Catch specific exceptions."
    severity: "WARNING"
    category: "STYLE"

  - id: "LIC-001"
    pattern: "(?i)(GNU General Public License|AGPL|Affero)"
    message: "Restricted License detected (GPL/AGPL). Please review compliance policy."
    severity: "BLOCKING"
    category: "COMPLIANCE"
